% !TeX root = ../thuthesis-example.tex

\chapter{相关工作}
\label{cha:related-work}

\section{三维医学模型重建}

颅颌面外科手术规划与成效预期的精确性依赖于对手术后软组织变形的精确模拟.
该过程至关重要, 且必须建立在解剖学细节上, 准确刻画的面部软组织模型之上.
传统上, 计算机图形学采用边界表示法 (如三角形网格) 或体积表示法 (如四面体网格) 来描绘实体物体的形态.
然而, 医学成像技术, 如计算机断层扫描 (CT), 所获取的数据往往呈现为非结构化网格, 这种格式的数据并不适宜于直接应用于手术的模拟和分析.
因此, 为确保这些数据能够满足后续处理的需求, 需进行恰当的数据预处理.
预处理步骤能够转换和优化原始数据, 从而为颅颌面外科的计算模拟提供准备就绪的输入, 以支撑手术规划的精确性和效果预测的可靠性.

Amberg 等研究者 \cite{ambergOptimalStepNonrigid2007} 对原始迭代最近点 (Iterative Closest Point, ICP) 算法框架进行了拓展, 适应了非刚性配准的需求, 同时维护了其在收敛性方面的固有特性.
此改进的方法引入了多种正则化策略, 借由在逐渐减小的刚性权重序列中循环求解, 实现模型向目标几何形状的渐进逼近, 以恢复全局和局部的形变.
Amberg 等人设计了一个算法, 核心在于运用局部仿射正则化技术.
该算法为每个网格顶点分配一个仿射变换, 并力图最小化相邻顶点之间变换的差别.
在多样化的数据类型处理上, 此方法表现出了杰出的效能.

在计算机图形学领域, 实体的形状一般通过边界表征来表达, 常用的方式例如三角形网格.
然而, 一旦能采用显式的体积表征, 如四面体网格, 动画制作、物理模拟以及几何处理等任务将更加贴近现实并提高精度.
鉴于此, Hang Si \cite{siTetGenDelaunaybasedQuality2015} 开发了 TetGen 软件, 专门用于生成高质量的四面体网格, 其初始目标是为数值分析和科学计算提供更优的支持.
面临许多理论和实践上的挑战, TetGen 软件基于 Delaunay 算法的核心原则进行构建, 这在理论上保障了算法的正确性.
实验结果证实, TetGen 能够稳定处理各类复杂的三维几何形态, 并在实践中展示出迅速的处理速度.
在生成四面体网格的过程中, 理想情形是能精确包含 (即插值) 所输入的边界模型.
然而, 在现实世界中的许多模型中, 达成该目标极为艰难, 因为这些模型通常包含众多的自相交现象、非流形结构和开放边界等缺陷, 而这正是传统网格划分算法所难以克服的难题.
为了应对这一挑战, Jacobson 等人 \cite{jacobsonRobustInsideoutsideSegmentation2013} 设计了一种稳健的自动算法, 该算法旨在解决以上所有提及的问题, 并实现对输入模型内部体积的精确离散化.
仅要求输入的三角形网格具备基本的一致朝向, 此方法通过扩展缠绕数概念至任意多边形, 定义了一个基于输入模型的划分函数.
当输入为一个密闭的三角形网格时, 该函数能实现模型的理想剖分; 即使面对带有各类缺陷的模型, 也能表现出卓越的功能性.
该划分函数进一步指导了一个约束 Delaunay 分割 (Constrained Delaunay Tessellation, CDT) 的图分割过程, 保证了产生的描述彻底满足边界的所有要求.

在近期的一项研究中, Zhang Xiaoyan 等学者 \cite{zhangEFacetemplateMethodEfficiently2016} 提出了一个创新性的半自动化技术 --- eFace-Template, 用于高效及精确地构建特定病人的面部软组织三维模型.
这一方法的突破性在于, 它采用了一个基于解剖学细节构造的模板, 并对其进行了体积形态的调整.
实现这一过程是通过结合标记驱动的混合形状变化技术与稠密表面配准方法, 再加上应用薄板样条 (Thin Plate Spline, TPS) 插值技术, 从而提高了模型的适应性.
这种方法在模型的拟合精度、解剖学准确性及网格品质方面, 达到了有效的平衡.

\section{手术模拟}

在正颌手术模拟这一领域, 学者们已经进行了大量深入的研究.
当前, 这些研究主要集中在两个方向: 一是数据驱动的方法, 辅以高级数据处理以模拟手术过程; 二是基于物理原理的仿真技术, 利用计算机模型来预测手术的实际效果.

\subsection{数据驱动的方法}

在计算机视觉领域, Qiu Zesong 等学者提出了一种创新的3D参数化面部模型, 名为 SCULPTOR, 该模型主要特征是其与骨骼一致性的特性 \cite{qiuSCULPTORSkeletonconsistentFace2022a}.
SCULPTOR模型建立于LUCY数据集之上, 通过划分面部模型为形态、姿态和表情几个组成部分, 达成了一种混合模型表达形式.
该框架采用参数驱动方法, 统筹兼顾头骨结构、面部几何和外观的综合建模, 能够细致描绘出人类面部的外貌特点及其背后的骨骼形态.
在此基础上, 引进的特质成分提供了一种工具, 用以模拟骨骼形态变化导致的面部形态的改变, 这对于预测正颌手术患者术后的面部外观变化具有极其重要的意义.

随着深度学习技术在计算机视觉领域的广泛成功, 传统深度学习方法集中研究不同的算法任务, 例如图像分类、目标检测和语义分割等.
近期, 学者们将视线转向了该技术在手术模拟场景中的应用.
Ma Lei 等研究者基于这样的背景, 开发了一种颇具革新性的面部模型预测网络 --- FSC-Net \cite{maSimulationPostoperativeFacial2023}.
此网络旨在学习骨骼形态变化到面部形态变化间非线性映射关系.
特别值得一提的是, FSC-Net 采用了点变换网络的架构, 并通过术前后的成对数据进行弱监督学习, 以优化训练进程, 而无需精确匹配每个顶点之间的对应关系.
网络所采用的距离指导下的形状损失函数特别强调对下颌区域能够精确的建模.
FSC-Net 为了保持表面网格的拓扑完整性, 并防范锐利或不实际变形的发生, 在局部顶点损失的计算中引入了顶点位移的约束机制.
通过实验评估表明, FSC-Net 在处理速度上比经典的有限元方法快了 15 倍, 而且保持了与传统方法相当的精确度.

在继续的研究中, Ma Lei 等人 \cite{maBidirectionalPredictionFacial2023} 在 P2P-Net \cite{yinP2PNETBidirectionalPoint2018} 的基础上进行深入的扩展, 推出了基于双向点对点卷积网络 (P2P-Conv) 的深度学习框架.
该框架专门针对编码面部与颅骨形态之间的转换问题而设计, 从而辅助正颌外科手术规划.
P2P-Conv 继承了 P2P-Net 的架构, 并加入了动态点卷积 (PointConv) , 以捕获从局部结构到整体结构的空间信息.
此框架还采用了一种多子集数据增强技术, 即利用面部与骨骼形态的多子集点数据来加强训练过程.
在推理阶段, 多子集生成的网络输出会综合处理, 得到一致性的稠密顶点变换预测结果.
实验结果显示, 在实际数据集中引入 P2P-Conv 可以有效提升面部及颅骨形态预测的准确度.
然而, 该方法尚未仔细处理不同个体之间的差异性——尽管有些个体的颅骨形状极为相似, 他们的面部形态之间可能会有显著的不同.

\subsection{物理仿真方法的探索}

在广泛的研究领域中, 面部软组织的计算建模已受到深入探讨.
依据所运用的计算技术的不同, 这些研究大致可以分为三个主要类别: 质量-弹簧模型 (Mass-Spring Model, MSM)、有限元模型 (Finite Element Model, FEM) 及质量-张量模型 (Mass-Tensor Model, MTM).
质量-弹簧模型 (MSM) 在计算效率上显示出其显著优势, 因而广泛应用于实时面部动画的生成.
Terzopoulos \cite{terzopoulosPhysicallyBasedFacial1990} 以及 Lee \cite{leeRealisticModelingFacial1995} 等学者发展了基于线性肌肉的 MSM, 从而实现了快速的面部模拟仿真.
另外, Keeve 等人 \cite{keeveDeformableModelingFacial1998} 引进了融合棱柱单元的 MSM, 并与有限元分析方法 (FEM) 在精度及计算成本方面进行了比较性研究.
Teschner 等人 \cite{teschnerDirectComputationNonlinear} 设计了一个带静态约束的多层非线性 MSM, 该模型能够直接计算出平衡状态.
Vicente 和他的同事 \cite{vicenteMaxillofacialSurgerySimulation2009} 采用 MSM 模拟了术后的面部外形变化.
他们基于六面体元素网格, 提出了一种新型 MSM, 此模型与线性有限元模型在理论上是等效的, 并进一步开发了位移尺度调整方法来更真实地再现软组织的物理行为.

在与经典质点弹簧模型 (Mass-Spring Model, MSM) 相比较时, 有限元模型 (Finite Element Model, FEM) 在模拟生物力学性质方面显现出较为突出的优越性, 尽管其在计算过程中所耗费的时间较为漫长.
Kim 等研究者 \cite{kimClinicallyValidatedPrediction2017} 提出了一种创新的三阶段 FEM 方法, 旨在通过模拟现实组织中的滑动现象, 以提高对面部软组织形变的预测准确性.
具体而言, 该方法的第一阶段依托于 eFace-Template 技术 \cite{zhangEFacetemplateMethodEfficiently2016} 来构建患者特有的网格模型, 并运用 FEM 模拟软组织的响应, 同时将手术后的骨骼位移视为定边界条件施加于所构建的模型中.
在第二阶段, 研究者采纳了节点力约束的手段来模拟牙龈组织与牙齿间的滑动作用, 此举大幅优化了模拟结果的质量.
在 FEM 方法的第三阶段, 通过重构软组织与骨骼之间的映射关系, 并运用节点间空间约束作为新的边界条件, 从而进一步提升了模拟组织滑动效应的仿真质量.
实验证实, 司聚焦软组织滑动效果的改良型 FEM 方法, 在模拟面部整体结构以及在临床关键部位——特别是鼻和口唇区域的精确度方面, 与现有的其他FEM方法相较, 均实现了显著的提高.

为了准确预测面部软组织在术后的位置变化, Knoops 等研究者 \cite{knoopsNovelSoftTissue2018} 提出了一种创新的概率性有限元分析模型.
该模型结合了实验设计方法 (Design Of Experiments, DOE) 和迭代优化策略, 成功生成了一系列搭载概率预测区间的三维 (3D) 面部模型.
这些模型特别针对鼻部和上唇区域, 能够以高准确性预测术后的实际位置.
相关研究详细阐述了建模不准确性及手术规划中执行不确定性如何对软组织预测结果构成影响.
此外, 该模型能够为手术规划过程提供了覆盖预期最小值和最大值的预测区间, 这一点对于帮助患者深入理解手术可能带来的面部变化尤为重要.

质量-张量模型 (Mass-Tensor Model, MTM) 最初设计宗旨在于实现计算效率与结果精度之间的最优平衡.
Cotin 等研究者 \cite{cotinHybridElasticModel2000} 率先提出了一种建基于 MTM 的混合模型, 该模型专注于模拟软组织的局部变形效应.
继之, Picinbono 等人 \cite{picinbonoNonlinearAnisotropicElasticity2003} 将混合模型扩展应用于非线性各向异性材料的研究领域.
Mollemans 及其团队 \cite{mollemansPredictingSoftTissue2007} 将 MTM 技术首次引入颅颌面手术的软组织模拟, 并从定量与定性两个维度, 通过临床案例对该技术的有效性进行了评估验证.
而 Kim 等人 \cite{kimNewSofttissueSimulation2010} 则在预测面部肌肉行为的研究中应用了横向各向同性的MTM模型, 并提出了一种既符合生物力学原则又高效的软组织仿真方法.

在此科研背景之上, Ichim 及其同事 \cite{ichimPhacePhysicsbasedFace2017} 推出了 Phace --- 一种基于物理法则的革新面部动画技术.
Phace 技术与传统的生成方法形成鲜明对比, 它通过最小化模拟中被动肌肉、主动肌肉以及刚性骨骼结构之间相互作用的非线性位势能, 以更精确地计算面部表情变化.
通过在仿真模型中整合碰撞与接触处理, Phace 有效规避了传统动画技术 (如混合形态建模) 常陷入的不一致性问题.
Phace 还引入了一种创新性的肌肉激活模型, 能够真实再现面部表情的复杂动态.
这项技术的应用前景极为广泛, 不仅限于艺术动画编辑, 还包括模拟矫形面部手术过程, 以及模拟面部与外部力量或物体的动态交互.
